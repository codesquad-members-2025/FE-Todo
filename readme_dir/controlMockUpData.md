# 새로고침시 기존의 카드를 다시 화면에 보여주는 기능설계

## 다뤄야 할 데이터

1. 기존 로컬에 존재하는 목업 JSON파일
2. 로컬 스토리지에 존재하는 사용자가 생성한 카드

-> 2번만 다뤄도 상관 없지만... 1번은 fetch API를 연습하는 차원에서 구현을 해야만 한다..!
-> 서버에서 JSON 데이터를 받아오지만 지금은 서버가 없으므로 로컬에서 물러오는 셈

## 목업 데이터 받아오기(js에서 다룰수 있는 형태로 받아온다)

### 로컬에서 받아오기

1. 로컬에 저장된 JSON파일을 fetch()로 파일을 불러온다.
2. 불러오면 js에서 다둘수 있는 객체 형태로 바꾸기 위해 respose의 메서드인 json을 사용해 js에서 사용할 수 있게 해준다.
   - 망상 코딩 (다음과 같이 로컬에서 목업 데이터를 받아온다.)

```javascript
async function fetchData() {
  const response = await fetch("./mochup.json"); //목업 데이터 경로로 데이터 불러온다.

  const data = await response.json();
  return data;
}
```

### 로컬 스토리지에서 받아오기

1. localStorage.getItem()으로 받아온다.
2. js에서 사용할 수 있는 형태로 바꾼다.

### 두개의 데이터를 합쳐야한다. => 병합 메서드 따로 만들어서 모듈화 필요

1. 노트에 설계완료.

```javascript
function mergeObjects(obj1, obj2) {
  const merged = { ...obj1 };
  Object.keys(obj2).forEach((key) => {
    if (Object.hasOwn(merged, key)) {
      merged[key] = { ...merged[key], ...obj2[key] };
    } else {
      merged[key] = { ...obj2[key] };
    }
  });

  return merged;
}
```

✅ 테스트 완료 -> 그대로 쓰면 된다.

- 위의 작업이 완료되면 js에서 목업 데이터를 다룰 수 있다.

## 받아온 데이터(목업 데이터 + 사용자 입력 데이터)를 뿌리는 함수 구현

1. 먼저 데이터를(모든 데이터===객체) 매개변수로 입력받아야 한다.
2. 입력 받은 객체를 순환하면서 카드 템플릿에 넣어줘야한다.(⚠️이때 절대 바보같이 dom에 추가하면서 반복하는 멍청한 짓은 하면 안된다.-> 왜? 계속해서 dom에 접근해서 수정하면 접근할 수록 느려진다. 한번에 데이터를 만들어서 dom에 넣는 작업은 한번만 해야한다.) 가상돔...? 사용 생각해보기
3. 이때 섹션은 총 3개가 있는데 먼저 크게 3개의 섹션을 구분 짓고, 그 아래에 각 카드 모달이 있게 만든다.
4. main 탬플릿에 만들어진 3개의 섹션을 매개변수로 넣는다.
5. main태그에 innerHTML로 바뀐 정보를 넣는다.

### 전략

1. makeTaskCard 탬플릿 이용해서 카드 생성
2. "1"과정을 머지된 데이터 만큼 "중첩"해서 생성한다(문자열로)
3. ".task-list" 에 innerHTML로 넣기. (여기가 카드 모달이 모여있는 공간)
4. ❓근데 이렇게 되면 DOM을 3번 조작하게 되는데... 이게 좋을까 아니면 main태그 전제를 조작해서 1번만 dom을 조작하는게 좋을까..? 근데 main태그를 수정하는 것은 범위가 크다.

- 결론은 각 섹션만 업데이트 해야한다!

  - 왜? 불필요한 main 전체 업데이트를 피해야한다. **_변경되는 부분만 렌더링 하자_**

- 로컬스토리지 데이터 저장 정보

```JSON
{
  "todo": {
    "1741845913823": {
      "title": "할 일 제목",
      "content": "할 일 내용"
    },
    "1741786771823": {
      "title": "공부 해야 할 것",
      "content": "수학 복습"
    }
  },
  "doing": { ... },
  "done": { ... }
}
```

#### makeTaskCard탬플릿 이용해 ".task-list"에 넣는 방법

- 먼저 데이터 정보를 불러온다.(객체 형태)
- 객체의 키배열로 나열한다. -> ["todo","doing",...]
- 이 배열을 순환하면서 **_각 섹션에 넣을 문자열(HTML)속성_**배열이 만들어져야한다. -> .map을 써야 한다.

- 그러면 [{"todo":"HTML 문자열"},{"doing":"HTML 문자열"},{"done":"HTML 문자열"}]

- 위의 문자열 배열을 순환 하면서 각 섹션 태그에 innerHTML로 넣으면 된다.
